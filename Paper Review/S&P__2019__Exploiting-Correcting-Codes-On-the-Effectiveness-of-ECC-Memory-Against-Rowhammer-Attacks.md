# Haowen Liu (2020-11-29)

# Paper information

- Title: Exploiting Correcting Codes: On the Effectiveness of ECC Memory Against Rowhammer Attacks
- Authors: Lucian Cojocar, Kaveh Razavi, Cristiano Giuffrida, Herbert Bos
- Venue: S&P 2019
- Keywords: ECC reverse engineering, reliable RowHammer attack, cold boot attack, timing side channel

# Paper content

## Summary

This paper breaks the assumption that Rowhammer attacks are really not practical on ECC memory by trigger the “*right*” combination of bit flips in a single code word to bypass ECC. 

First, they reverse engineer ECC functions in DIMMs by analysing the property of *linear block codes* and ECC functions as *theoretical foundation*, proposing three pratical methods to inject errors in memory (***syringe needle probe***, memory controller service and Rowhammer bit flips), and then conducting ***cold boot attack*** to derive ECC *syndromes* to *recover the complete ECC function*.

Second, to obtain the combination of bit flips that shall not be detected by or crash the system (bypass ECC), they first use a novel timing ***side channel*** based on the fact that accesses to data triggering correctable ECC errors are evidently slower than those to data with no bit flips (conducting experiments), to observe the ECC-aware Rowhammer bit flips they can achieve. Then they manipulate aggressor data bits to obtain fully composable, data-controlled bit flips after demonstrating that *stripe* data pattern is effectively flipping bits and that there is negligible cross-bit-flip interference, to combine correctable bit flips (1-bit templates) found above to create error patterns that the ECC function is unable to detect.

Finally, they launch *exploits* on three different victims: *page table entries*, *RSA public keys*, and *binary opcode* using indetectable error patterns found above, and get success rates of $2.5\%|39.9\%$, $45.1\%|37\%|28.7\%$, $5\% \sim 10\%$ respectively, showing the effectiveness and reliability of ***ECCploit* attack**.

In the end they propose three directions to mitigate the dilemma that ECC is not free from RowHammer: 1) combine ECC with TRR; 2) devise new Rowhammer-aware ECC algorithms that can be deployed either in hardware or software; 3) increase the DRAM refresh rate.


## Strengths

- This paper is the first to conduct existing Rowhammer attacks on ECC memory, which is perceived not practical in the past.
- Three innovations: 1) reverse engineer ECC functions in DIMMs; 2) find a novel timing side channel; 3) use syringe needle probe to inject errors in memory.
- Present a **complete**, reliable and reproductive attack chain, from analysing mechanisms and feasibility, collecting data, conducting attacks, to achieving success. And give three typical attack examples.
- Conduct lots of sophisticated and effective techniques like hardware reverse engineering, cold boot attack and side channel.
- Solid theoretical and experimental foundation.

## Weaknesses

- The attack is so **constrained and complex** that it costs a lot to conduct (days, even months). And due to its narrow margins attackers cannot always find appropriate combination of bit flips to conduct attacks.
- The attack chain is **fragile**. Every node in the chain is hard to conduct and has few substitutes, especially the side channel step.
- In Section VI-A though they propose the access time peak is sufficient to reliably distinguish error from error-free cases on Intel-1 (and they mistake writing it as AMD-1), but from Figure 4 the fault tolerance is too small and they cannot explain the relatively flattened peak near $0$. And there is no ordinate scale in Figure 4, which is necessary for us to know the side channel margins.

## Paper presentation

- Compact writing. Substantial content.
- ***Writing error.*** In the third paragraph of Section VI-A, I think they mistake writing these two setups, Intel-1 and AMD-1, backwards, considering the context. Figure 3 depicts AMD-1 and Figure 4 describe Intel-1, not the reverse. The right discription can be found in ***ECC error handling in practice*** part also in Section VI-A.

## Thoughts
- To defend against *ECCploit* we should focus on the vulnerability of its attack chain, which is mentioned above, the side channel step. Manufacturers can design an on-die mechanism to accelarate the ECC correcting and reporting process to **narrow the difference** between accesses to data triggering correctable ECC errors and those to data with no bit flips to mask the side channel, or randomly select accesses to rows with no bit flips but artificially set them long access time to **cheat attacker’s side channel**.
- To strengthen the attack chain we should find substitute for timing side channel to observe the ECC-aware Rowhammer bit flips, maybe some mechanism to track the ECC process, for exploiting ECC is the only way to observe flip bits in reality ECC memory.

## Takeaways and questions

This paper shows me what a *Security* masterpiece is: 1) solid theoretical fundation across mathematics, information theory, memory and CPU mechanisms, coding theory, number theory and abstract algebra, which are all included in this paper; 2) lots of innovations and fantasies, like using syringe needle to induce errors in memory; 3) sophisticated security and adversary skills and techniques, like hardware reverse engineering, cold boot attack and side channel; 4) the ability to construct a complete attack chain; 5) brilliant writing skills.

Though *ECCploit* successfully bypasses ECC, it is also laudable that ECC considerably increases the difficulty to conduct Rowhammer attacks. Or we can conclude that there is not a way to achieve complete security. Every mechanism has its own vulnerability, which can always be compromised by attacker if regardless of cost. In spirit, security is about increasing the cost of attack as much as possible and deciding what trade-off made between security overhead and effectiveness.

