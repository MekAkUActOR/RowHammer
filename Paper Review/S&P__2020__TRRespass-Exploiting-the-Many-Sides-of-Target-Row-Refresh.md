# Haowen Liu (2020-12-01)

# Paper information

- Title: TRRespass: Exploiting the Many Sides of Target Row Refresh
- Authors: Pietro Frigo, Emanuele Vannacci, Hasan Hassan, Victor van der Veen, Onur Mutlu, Cristiano Giuffrida, Herbert Bos, Kaveh Razavi
- Venue: IEEE S&P 2020
- Keywords: Target Row Refresh (TRR), Many-sided RowHammer, DDR4, hardware fuzzing

# Paper content

## Summary

To bypass TRR implemented in DDR4 with the laudable effectiveness against RowHammer attacks, whose mechanism is very little known, this paper designs *TRRespass*, a black-box many-sided RowHammer fuzzer, to find sophisticated hammering access patterns automatically to mount real-world attacks.

First, the paper conducts experiments on *SoftMC* (an FPGA-based memory controller which provides fine-grained control over the commands sent to DRAM) to investigate the mechanism of TRR inside recent DRAM chips. They *hypothesize* TRR consists of two requirements: the ***sampler*** (track rows being hammered) and the ***inhibitor*** (thwart the hammering process by refreshing victim rows or row remapping). By using *SoftMC* to issue crafted `REFRASH` batches (batches of `REFRASH` commands sent in different patterns) to DRAM modules, they find some important features of TRR: 1) TRR carries out a targeted refresh on every refresh command; 2) TRR samples more than one aggressor within a refresh interval and the sampler have a **limited size**, which can be revealed by overflowing it (many-sided RowHammer); 3) TRR performs command-order-based (the sampler records row activations at specific commands and likely at specific ordering of commands) and row-address-dependent (the sampling mechanism is affected by the addresses of aggressor rows) sampling.

Second, they design *TRRespass* to generate effective access patterns automatically by ***randomizing*** the cardinality and location parameters (the number and addresses of rows in an access pattern). They test *TRRespass* on several DDR4 and LPDDR4(X) modules and show effectiveness and scalability. Using *TRRespass*, they conduct classical exploitations in reality (*PTE*, *RSA-2048*, *`sudo`*) and success on some DRR4 modules. However, actually they only conduct **memory templating** (finding the RowHammer templates in memory, such as row addresses, access patterns, bit-flip offsets and directions and data patterns) step to evaluate the feasibility of *TRRespass* exploitation but not a complete attack chain.

Finally this paper criticizes the *security by obscurity* strategy of DRAM vendors for putting computing systems at risk for extended periods of time.


## Strengths

- This paper is the first to investigate the effectiveness and mechanisms of TRR in modern DRR4 modules, in *hypothesis-deduction* method (though they do not make it clear in the paper).
- Design a scalable black-box RowHammer fuzzer to generate effective access patterns automatically to bypass in-DRAM TRR. Demonstrate that TRR-equipped DRAM is not immune to RowHammer.
- Criticizes the *security by obscurity* strategy of DRAM vendors.

## Weaknesses

- To complete the *hypothesis-deduction* process at least they should characterize a TRR mechanism in one kind of DRR4 module clearly and deeply and demonstrate their observation by experiments, rather than stopping on shallow concept.
- *TRRespass*â€™s fuzzing strategy is inefficient and speculative, and its final success rate is also not good. It just randomizes the cardinality and location parameters to generate access patterns. A wiser attacker would dig deeper about TRR and use a more targeted way to bypass it. But at least the fuzzing way demonstrates that there are access patterns to bypass TRR. It's more theoretical than practical.
- They only conduct *memory templating* to evaluate the feasibility of *TRRespass* exploitation, but do not achieve a complete attack train. It is not rigorous in academic research. Successfully generating an access pattern does not mean achieving a successful exploitation, and prior works the paper refers to also did not achieve a $100\%$ success rate with available access patterns. So the success rates of *TRRespass* are even lower, though it is not performing well in *memory templating*.

## Paper presentation

- Figures are pretty.
- Parts of the article are not closely linked.

## Thoughts
- In Section VI-A they calculate that the maximum of effective rows they can hammer simultaneously in a refresh retention interval is $28$ (now, but the number will increase with the vulnerability of DRAM), so TRR using a sampler and inhibitor whose size is near or over $28$ rows can completely defend against RowHammer, I guess, because attacker can hardly overflow the sampler anymore.
- TRR is a plain but effective idea to defend against RowHammer. With carefully crafted sampling and inhibiting strategy, it shows great effectiveness in this paper. Although its details are still covered up by DRAM vendors, it is still promising to find more effective sampling and inhibiting strategies to improve its performance against RowHammer, such as command-order dependency and row-address dependency, cooperating with CPU and memory controller. After all, *TRRespass* is only a fuzzer based on randomization. If the TRR strategy is complex enough, the probability of finding a workable access pattern is very small, and a randomized fuzzer *cannot* afford the cost of bypassing it.

## Takeaways and questions

Though the *security by obscurity* strategy violates the principle of academic openness and slows down the research on RowHammer mitigation, as "attackers", even if researchers do not know the details of mitigation mechanisms used by vendors, they should have the ability to make them clear, by reverse-engineering or other ways.