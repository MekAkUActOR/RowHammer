# Haowen Liu (2020-12-01)

# Paper information

- Title: TRRespass: Exploiting the Many Sides of Target Row Refresh
- Authors: Pietro Frigo, Emanuele Vannacci, Hasan Hassan, Victor van der Veen, Onur Mutlu, Cristiano Giuffrida, Herbert Bos, Kaveh Razavi
- Venue: S&P 2020
- Keywords: Target Row Refresh (TRR), Many-sided RowHammer, DDR4, hardware fuzzing

# Paper content

## Summary

To bypass TRR implemented in DDR4 with the laudable effectiveness against RowHammer attacks, whose mechanism is very little known, this paper designs *TRRespass*, a black-box many-sided RowHammer fuzzer, to find sophisticated hammering access patterns automatically to mount real-world attacks.

First, the paper conducts experiments on *SoftMC* to investigate the mechanism of TRR inside recent DRAM chips. They *hypothsize* TRR consists of two requirements: the ***sampler*** (track rows being hammered) and the ***inhibitor*** (thwart the hammering process by refreshing victim rows or row remapping). By using *SoftMC* to issue crafted `REFRASH` batches to DRAM modules, they find some important features of TRR: 1) TRR carries out a targeted refresh on every refresh command; 2) TRR samples more than one aggressor within a refresh interval and the sampler have a **limited size**, which can be revealed by overflowing it (many-sided RowHammer); 3) TRR performs command-order-based and row-address-dependent sampling.

Second, they design *TRRespass* to generate effective access patterns automatically by ***randomizing*** the cardinality and location parameters. They test *TRRespass* on several DDR4 and LPDDR4(X) modules and show effectiveness and scalability. Using *TRRespass*, they conduct classical exploitations in reality (*PTE*, *RSA-2048*, *`sudo`*) and success on some DRR4 modules. However, actually they only conduct **memory templating** to evaluate the feasibility of *TRRespass* exploitation.

Finally this paper criticizes the *security by obscurity* strategy of DRAM vendors for putting computing systems at risk for extended periods of time.


## Strengths

- This paper is the first to investigate the effectiveness and mechanisms of TRR in modern DRR4 modules, in *hypothesis-deduction* method (though they do not make it clear in the paper).
- Design a scalable black-box RowHammer fuzzer to generate effective access patterns automatically to bypass in-DRAM TRR.
- Criticizes the *security by obscurity* strategy of DRAM vendors.

## Weaknesses

- The thunder roars loudly, but little rain falls. They highlight their contributions at the beginning but what we see finally are shallow investigations on TRR and simple solution. The mechanisms of TRR they reveal are only some basic and apparent properties necessary for “*Target Row Refresh*", and *TRRespass* is just a simple randomized fuzzer, even having nothing to do with previous investigations on TRR. At least they should characterize a TRR mechanism in one kind of DRR4 module clearly and deeply, instead of replacing apparent principles with professional and obscure statements.
- *TRRespass*’s fuzzing strategy is inefficient and speculative, and its final success rate is also not good. It just randomizes the cardinality and location parameters to generate access patterns. A wiser attacker would dig deeper about TRR and use a more targeted way to bypass it. But at least the fuzzing way demonstrates that there are access patterns to bypass TRR. It's more theoretical than practical.
- They only conduct *memory templating* to evaluate the feasibility of *TRRespass* exploitation, but do not achieve a complete attack train. It is not rigorous in academic research. Successfully generating an access pattern does not mean achieving a successful exploitation, and prior works the paper refers to also did not achieve a $100\%$ success rate with available access patterns. So the success rates of *TRRespass* are even lower, though it is not performing well in *memory templating*.

## Paper presentation

- Figures are beautiful.
- Parts of the article are not closely linked.

## Thoughts
- In Section VI-A they calculate that the maximum of effective rows they can hammering simultaneously in a refresh retention interval is $28$ (now, but the number will increase with the vulnerablity of DRAM), so TRR using a sampler and inhibitor whose size is near or over $28$ rows can completely defend against RowHammer, I guess, because attacker can hardly overflow the sampler anymore.
- TRR is a plain but effective idea to defend against RowHammer. With carefully crafted sampling and inhibiting strategy, it shows great effectiveness in this paper. Although its details are still covered up by DRAM vendors, it is still promising to find more effective sampling and inhibiting strategies to improve its performance against RowHammer, such as command-order dependency and row-address dependency, cooperating with CPU and memory controller. After all, *TRRespass* is only a randomized fuzzer. If the TRR strategy is complex enough, the probability of finding a workable access pattern is very small, and a randomized fuzzer *cannot* afford the cost of bypassing it.

## Takeaways and questions

This paper criticizes the *security by obscurity* strategy of DRAM vendors. In fact this strategy violates the principle of academic openness and slows down the research on RowHammer mitigation. But as “attackers”, even if do not know the details of mitigation mechanisms used by vendors, researchers should have the ability to make them clear, by reverse engineering or other ways. 